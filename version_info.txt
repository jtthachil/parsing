Version from 02 April
Thread lock implemented